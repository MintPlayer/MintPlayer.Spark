<div class="container">
  @if (entityType && item) {
    <h2 class="mb-4">Edit {{ entityType.name }}</h2>

    <div class="card">
      <div class="card-body">
        <form (ngSubmit)="onSave()">
          @for (attr of getEditableAttributes(); track attr.id) {
            <div class="mb-3">
              <label [for]="attr.name" class="form-label">
                {{ attr.label || attr.name }}
                @if (attr.isRequired) {
                  <span class="text-danger">*</span>
                }
              </label>
              @if (attr.dataType === 'boolean') {
                <div class="form-check">
                  <input
                    type="checkbox"
                    class="form-check-input"
                    [id]="attr.name"
                    [(ngModel)]="formData[attr.name]"
                    [name]="attr.name">
                </div>
              } @else if (attr.dataType === 'reference') {
                <select
                  class="form-select"
                  [id]="attr.name"
                  [(ngModel)]="formData[attr.name]"
                  [name]="attr.name"
                  [required]="attr.isRequired">
                  <option value="">-- Select --</option>
                  @for (option of getReferenceOptions(attr); track option.id) {
                    <option [value]="option.id">{{ option.breadcrumb || option.name }}</option>
                  }
                </select>
              } @else {
                <input
                  [type]="getInputType(attr.dataType)"
                  class="form-control"
                  [id]="attr.name"
                  [(ngModel)]="formData[attr.name]"
                  [name]="attr.name"
                  [required]="attr.isRequired"
                  [step]="attr.dataType === 'decimal' ? '0.01' : '1'">
              }
            </div>
          }

          <div class="d-flex justify-content-end gap-2">
            <button type="button" class="btn btn-outline-secondary" (click)="onCancel()">Cancel</button>
            <button type="submit" class="btn btn-primary">Save</button>
          </div>
        </form>
      </div>
    </div>
  } @else {
    <div class="text-center p-5">
      <div class="spinner-border" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>
  }
</div>
